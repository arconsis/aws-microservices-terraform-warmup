const databaseFactory = require('./db');
const dataStoresFactory = require('./dataStores');
const {
  validateConfig,
} = require('./common/utils');

module.exports = {
  create(config) {
    try {
      validateConfig(config);
    } catch (error) {
      throw error;
    }
    const db = databaseFactory(config);
    const dataStores = dataStoresFactory(db);
    return Object.assign(
      {},
      db,
      {
        dataStores,
      },
    );
  },
};
